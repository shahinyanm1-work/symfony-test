<?php

declare(strict_types=1);

namespace DoctrineMigrations;

use Doctrine\DBAL\Schema\Schema;
use Doctrine\Migrations\AbstractMigration;

/**
 * Auto-generated Migration: Please modify to your needs!
 */
final class Version20251003061324 extends AbstractMigration
{
    public function getDescription(): string
    {
        return '';
    }

    public function up(Schema $schema): void
    {
        // this up() migration is auto-generated, please modify it to your needs
        $this->addSql('DROP INDEX IDX_user_id ON orders');
        $this->addSql('DROP INDEX IDX_tracking_number ON orders');
        $this->addSql('DROP INDEX IDX_pay_type ON orders');
        $this->addSql('DROP INDEX IDX_orders_date_range ON orders');
        $this->addSql('DROP INDEX IDX_orders_composite_search ON orders');
        $this->addSql('DROP INDEX IDX_orders_aggregation ON orders');
        $this->addSql('DROP INDEX IDX_delivery_country ON orders');
        $this->addSql('ALTER TABLE orders CHANGE id id BIGINT UNSIGNED AUTO_INCREMENT NOT NULL, CHANGE uuid uuid VARCHAR(36) NOT NULL, CHANGE hash hash VARCHAR(64) NOT NULL, CHANGE user_id user_id BIGINT UNSIGNED DEFAULT NULL, CHANGE token token VARCHAR(64) NOT NULL, CHANGE number number VARCHAR(50) DEFAULT NULL, CHANGE status status SMALLINT NOT NULL, CHANGE email email VARCHAR(150) DEFAULT NULL, CHANGE vat_type vat_type SMALLINT NOT NULL, CHANGE vat_number vat_number VARCHAR(64) DEFAULT NULL, CHANGE discount discount SMALLINT DEFAULT NULL, CHANGE delivery_price delivery_price NUMERIC(12, 2) DEFAULT NULL, CHANGE delivery_type delivery_type SMALLINT NOT NULL, CHANGE delivery_index delivery_index VARCHAR(20) DEFAULT NULL, CHANGE delivery_country delivery_country INT DEFAULT NULL, CHANGE delivery_region delivery_region VARCHAR(100) DEFAULT NULL, CHANGE delivery_city delivery_city VARCHAR(200) DEFAULT NULL, CHANGE delivery_address delivery_address VARCHAR(300) DEFAULT NULL, CHANGE delivery_phone delivery_phone VARCHAR(50) DEFAULT NULL, CHANGE client_name client_name VARCHAR(150) DEFAULT NULL, CHANGE client_surname client_surname VARCHAR(150) DEFAULT NULL, CHANGE company_name company_name VARCHAR(255) DEFAULT NULL, CHANGE pay_type pay_type SMALLINT NOT NULL, CHANGE pay_date_execution pay_date_execution DATETIME DEFAULT NULL, CHANGE proposed_date proposed_date DATETIME DEFAULT NULL, CHANGE ship_date ship_date DATETIME DEFAULT NULL, CHANGE tracking_number tracking_number VARCHAR(100) DEFAULT NULL, CHANGE manager_name manager_name VARCHAR(100) DEFAULT NULL, CHANGE manager_email manager_email VARCHAR(100) DEFAULT NULL, CHANGE locale locale VARCHAR(10) NOT NULL, CHANGE cur_rate cur_rate NUMERIC(12, 6) NOT NULL, CHANGE currency currency VARCHAR(3) NOT NULL, CHANGE measure measure VARCHAR(5) NOT NULL, CHANGE name name VARCHAR(200) NOT NULL, CHANGE description description LONGTEXT DEFAULT NULL, CHANGE created_at created_at DATETIME NOT NULL, CHANGE updated_at updated_at DATETIME NOT NULL, CHANGE warehouse_data warehouse_data JSON DEFAULT NULL, CHANGE address_equal address_equal TINYINT(1) NOT NULL, CHANGE accept_pay accept_pay TINYINT(1) NOT NULL, CHANGE weight_gross weight_gross NUMERIC(12, 3) DEFAULT NULL, CHANGE payment_euro payment_euro TINYINT(1) NOT NULL, CHANGE spec_price spec_price TINYINT(1) NOT NULL, CHANGE delivery_apartment_office delivery_apartment_office VARCHAR(30) DEFAULT NULL');
        $this->addSql('ALTER TABLE orders_article DROP FOREIGN KEY `FK_orders_article_order`');
        $this->addSql('ALTER TABLE orders_article CHANGE id id BIGINT UNSIGNED AUTO_INCREMENT NOT NULL, CHANGE order_id order_id BIGINT UNSIGNED NOT NULL, CHANGE article_id article_id INT NOT NULL, CHANGE article_code article_code VARCHAR(100) DEFAULT NULL, CHANGE article_name article_name VARCHAR(255) DEFAULT NULL, CHANGE amount amount NUMERIC(12, 4) NOT NULL, CHANGE price price NUMERIC(12, 2) NOT NULL, CHANGE price_eur price_eur NUMERIC(12, 2) DEFAULT NULL, CHANGE currency currency VARCHAR(3) DEFAULT NULL, CHANGE measure measure VARCHAR(5) DEFAULT NULL, CHANGE delivery_time_min delivery_time_min DATE DEFAULT NULL, CHANGE delivery_time_max delivery_time_max DATE DEFAULT NULL, CHANGE weight weight NUMERIC(12, 3) DEFAULT NULL, CHANGE packaging_count packaging_count NUMERIC(12, 4) DEFAULT NULL, CHANGE pallet pallet NUMERIC(12, 4) DEFAULT NULL, CHANGE packaging packaging NUMERIC(12, 4) DEFAULT NULL, CHANGE swimming_pool swimming_pool TINYINT(1) NOT NULL, CHANGE created_at created_at DATETIME NOT NULL, CHANGE updated_at updated_at DATETIME NOT NULL');
        $this->addSql('ALTER TABLE orders_article ADD CONSTRAINT FK_F34F7C1D8D9F6D38 FOREIGN KEY (order_id) REFERENCES orders (id) ON DELETE CASCADE');
    }

    public function down(Schema $schema): void
    {
        // this down() migration is auto-generated, please modify it to your needs
        $this->addSql('ALTER TABLE orders CHANGE id id BIGINT UNSIGNED AUTO_INCREMENT NOT NULL, CHANGE uuid uuid CHAR(36) NOT NULL COMMENT \'UUID v4 for external references\', CHANGE hash hash VARCHAR(64) NOT NULL COMMENT \'Unique hash for public access\', CHANGE user_id user_id BIGINT UNSIGNED DEFAULT NULL COMMENT \'Reference to users table (if exists)\', CHANGE token token VARCHAR(64) NOT NULL COMMENT \'Security token for order access\', CHANGE number number VARCHAR(50) DEFAULT NULL COMMENT \'Human-readable order number\', CHANGE status status SMALLINT UNSIGNED DEFAULT 1 NOT NULL COMMENT \'Order status: 1=pending, 2=confirmed, 3=shipped, 4=delivered, 5=cancelled\', CHANGE email email VARCHAR(150) DEFAULT NULL COMMENT \'Customer email\', CHANGE vat_type vat_type TINYINT(1) DEFAULT 0 NOT NULL COMMENT \'VAT type: 0=none, 1=individual, 2=company\', CHANGE vat_number vat_number VARCHAR(64) DEFAULT NULL COMMENT \'VAT registration number\', CHANGE discount discount SMALLINT DEFAULT NULL COMMENT \'Discount percentage (0-100)\', CHANGE delivery_price delivery_price NUMERIC(12, 2) DEFAULT NULL COMMENT \'Delivery cost in order currency\', CHANGE delivery_type delivery_type TINYINT(1) DEFAULT 0 COMMENT \'Delivery type: 0=standard, 1=express, 2=pickup\', CHANGE delivery_index delivery_index VARCHAR(20) DEFAULT NULL COMMENT \'Postal code\', CHANGE delivery_country delivery_country INT DEFAULT NULL COMMENT \'Country code (ISO)\', CHANGE delivery_region delivery_region VARCHAR(100) DEFAULT NULL COMMENT \'State/Region\', CHANGE delivery_city delivery_city VARCHAR(200) DEFAULT NULL COMMENT \'City\', CHANGE delivery_address delivery_address VARCHAR(300) DEFAULT NULL COMMENT \'Street address\', CHANGE delivery_phone delivery_phone VARCHAR(50) DEFAULT NULL COMMENT \'Contact phone\', CHANGE client_name client_name VARCHAR(150) DEFAULT NULL COMMENT \'Customer first name\', CHANGE client_surname client_surname VARCHAR(150) DEFAULT NULL COMMENT \'Customer last name\', CHANGE company_name company_name VARCHAR(255) DEFAULT NULL COMMENT \'Company name (for B2B)\', CHANGE pay_type pay_type TINYINT(1) DEFAULT 0 NOT NULL COMMENT \'Payment type: 0=card, 1=bank_transfer, 2=cash, 3=paypal\', CHANGE pay_date_execution pay_date_execution DATETIME DEFAULT NULL COMMENT \'Payment execution date\', CHANGE proposed_date proposed_date DATETIME DEFAULT NULL COMMENT \'Proposed delivery date\', CHANGE ship_date ship_date DATETIME DEFAULT NULL COMMENT \'Actual shipping date\', CHANGE tracking_number tracking_number VARCHAR(100) DEFAULT NULL COMMENT \'Shipping tracking number\', CHANGE manager_name manager_name VARCHAR(100) DEFAULT NULL COMMENT \'Assigned manager name\', CHANGE manager_email manager_email VARCHAR(100) DEFAULT NULL COMMENT \'Manager email\', CHANGE locale locale VARCHAR(10) DEFAULT \'en\' NOT NULL COMMENT \'Customer locale\', CHANGE cur_rate cur_rate NUMERIC(12, 6) DEFAULT \'1.000000\' COMMENT \'Currency exchange rate\', CHANGE currency currency CHAR(3) DEFAULT \'EUR\' NOT NULL COMMENT \'Order currency (ISO 4217)\', CHANGE measure measure VARCHAR(5) DEFAULT \'m\' NOT NULL COMMENT \'Measurement unit: m, cm, mm\', CHANGE name name VARCHAR(200) NOT NULL COMMENT \'Order name/title\', CHANGE description description TEXT DEFAULT NULL COMMENT \'Order description/notes\', CHANGE created_at created_at DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL COMMENT \'Creation timestamp\', CHANGE updated_at updated_at DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL COMMENT \'Last update timestamp\', CHANGE warehouse_data warehouse_data JSON DEFAULT NULL COMMENT \'Warehouse-specific data\', CHANGE address_equal address_equal TINYINT(1) DEFAULT 1 COMMENT \'Delivery address equals billing address\', CHANGE accept_pay accept_pay TINYINT(1) DEFAULT 0 COMMENT \'Payment accepted flag\', CHANGE weight_gross weight_gross NUMERIC(12, 3) DEFAULT NULL COMMENT \'Total weight in kg\', CHANGE payment_euro payment_euro TINYINT(1) DEFAULT 0 COMMENT \'Payment in EUR flag\', CHANGE spec_price spec_price TINYINT(1) DEFAULT 0 COMMENT \'Special pricing flag\', CHANGE delivery_apartment_office delivery_apartment_office VARCHAR(30) DEFAULT NULL COMMENT \'Apartment/office number\'');
        $this->addSql('CREATE INDEX IDX_user_id ON orders (user_id)');
        $this->addSql('CREATE INDEX IDX_tracking_number ON orders (tracking_number)');
        $this->addSql('CREATE INDEX IDX_pay_type ON orders (pay_type)');
        $this->addSql('CREATE INDEX IDX_orders_date_range ON orders (created_at, status)');
        $this->addSql('CREATE INDEX IDX_orders_composite_search ON orders (client_name, client_surname, email, company_name, number)');
        $this->addSql('CREATE INDEX IDX_orders_aggregation ON orders (created_at, status, currency)');
        $this->addSql('CREATE INDEX IDX_delivery_country ON orders (delivery_country)');
        $this->addSql('ALTER TABLE orders_article DROP FOREIGN KEY FK_F34F7C1D8D9F6D38');
        $this->addSql('ALTER TABLE orders_article CHANGE id id BIGINT UNSIGNED AUTO_INCREMENT NOT NULL, CHANGE article_id article_id INT NOT NULL COMMENT \'Article/product ID\', CHANGE article_code article_code VARCHAR(100) DEFAULT NULL COMMENT \'Article code/SKU\', CHANGE article_name article_name VARCHAR(255) DEFAULT NULL COMMENT \'Article name\', CHANGE amount amount NUMERIC(12, 4) NOT NULL COMMENT \'Quantity ordered\', CHANGE price price NUMERIC(12, 2) NOT NULL COMMENT \'Unit price in order currency\', CHANGE price_eur price_eur NUMERIC(12, 2) DEFAULT NULL COMMENT \'Unit price in EUR\', CHANGE currency currency CHAR(3) DEFAULT NULL COMMENT \'Price currency\', CHANGE measure measure VARCHAR(5) DEFAULT NULL COMMENT \'Measurement unit for this item\', CHANGE delivery_time_min delivery_time_min DATE DEFAULT NULL COMMENT \'Earliest delivery date\', CHANGE delivery_time_max delivery_time_max DATE DEFAULT NULL COMMENT \'Latest delivery date\', CHANGE weight weight NUMERIC(12, 3) DEFAULT NULL COMMENT \'Item weight in kg\', CHANGE packaging_count packaging_count NUMERIC(12, 4) DEFAULT NULL COMMENT \'Packaging units\', CHANGE pallet pallet NUMERIC(12, 4) DEFAULT NULL COMMENT \'Pallets needed\', CHANGE packaging packaging NUMERIC(12, 4) DEFAULT NULL COMMENT \'Packaging units\', CHANGE swimming_pool swimming_pool TINYINT(1) DEFAULT 0 NOT NULL COMMENT \'Swimming pool related item\', CHANGE created_at created_at DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL COMMENT \'Creation timestamp\', CHANGE updated_at updated_at DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL COMMENT \'Last update timestamp\', CHANGE order_id order_id BIGINT UNSIGNED NOT NULL COMMENT \'Reference to orders table\'');
        $this->addSql('ALTER TABLE orders_article ADD CONSTRAINT `FK_orders_article_order` FOREIGN KEY (order_id) REFERENCES orders (id) ON UPDATE CASCADE ON DELETE CASCADE');
    }
}
